from ..openlibrary import OpenLibrary

json = {
    "links": {
        "self": "/authors/OL2830895A/works.json?limit=1000",
        "author": "/authors/OL2830895A",
    },
    "size": 13,
    "entries": [
        {
            "description": "The Name of the Wind, also called The Kingkiller Chronicle: Day One, is a heroic fantasy novel written by American author Patrick Rothfuss. It is the first book in the ongoing fantasy trilogy The Kingkiller Chronicle, followed by The Wise Man's Fear. It was published on March 27, 2007, by DAW Books.\r\n\r\nFollowed by: [The Wise Man's Fear][2]\r\n\r\n\r\n  [2]: https://openlibrary.org/works/OL8479869W",
            "links": [
                {
                    "title": "patrickrothfuss.com/content/books.asp",
                    "url": "https://www.patrickrothfuss.com/content/books.asp",
                    "type": {"key": "/type/link"},
                },
                {
                    "url": "https://en.wikipedia.org/wiki/The_Name_of_the_Wind",
                    "title": "Wikipedia Entry",
                    "type": {"key": "/type/link"},
                },
            ],
            "title": "The Name of the Wind",
            "covers": [
                11480483,
                8118709,
                8259359,
                10132698,
                10643548,
                11218173,
                8761267,
                10526441,
                12292096,
            ],
            "subject_places": ["Newarre", "Tarbean", "The University"],
            "subjects": [
                "orphans",
                "American fantasy fiction",
                "Adult books for young adults",
                "epic fiction",
                "series",
                "Juvenile audience",
                "demons",
                "quests",
                "loss (psychology)",
                "fate and fatalism",
                "voyages and travels",
                "heroes and heroines",
                "murder",
                "rulers",
                "gods and goddesses",
                "imaginary places",
                "good and evil",
                "fantasy fiction",
                "The Kingkiller Chronicle",
                "fantasy",
                "assassins",
                "Quill Award winner",
                "Alex Award winner",
                "Magic",
                "Magician",
                "Wizards",
                "Fiction",
                "Magicians",
                "Magos",
                "Magia",
                "Asesinos",
                "Novela fant\u00e1stica",
                "Ficci\u00f3n",
                "Homeless children",
                "Antiheroes",
                "Storytelling",
                "Legends",
                "Fiction, fantasy, epic",
                "nyt:mass-market-paperback=2015-01-04",
                "New York Times bestseller",
            ],
            "subject_people": [
                "Kvothe",
                "Chronicler",
                "Abenthy",
                "Bast",
                "Denna",
                "Ambrose",
                "Simmon",
                "Wilem",
                "Fela",
                "Cinder",
                "Lord Haliax",
                "Lanre",
                "Master Hemme",
                "Elodin",
                "Taborlin the Great",
                "the Chandrian",
                "the Fae",
            ],
            "key": "/works/OL8479867W",
            "authors": [
                {
                    "author": {"key": "/authors/OL2830895A"},
                    "type": {"key": "/type/author_role"},
                },
                {
                    "author": {"key": "/authors/OL9493618A"},
                    "type": {"key": "/type/author_role"},
                },
            ],
            "excerpts": [
                {
                    "author": {"key": "/people/seabelis"},
                    "comment": "first sentence",
                    "excerpt": "It was night again.",
                }
            ],
            "type": {"key": "/type/work"},
            "latest_revision": 26,
            "revision": 26,
            "created": {
                "type": "/type/datetime",
                "value": "2009-12-10T22:50:49.125618",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-12-03T19:06:08.431092",
            },
        },
        {
            "description": "Preceded by: [The Name of the Wind][1]\r\n\r\nIn The Wise Man's Fear, Kvothe searches for answers, attempting to uncover the truth about the mysterious Amyr, the Chandrian, and the death of his parents. Along the way, Kvothe is put on trial by the legendary Adem mercenaries, forced to reclaim the honor of his family, and travels into the Fae realm. There he meets Felurian, the faerie woman no man can resist, and who no man has ever survived...until Kvothe.\r\n\r\nNow, Kvothe takes his first steps on the path of the hero and learns how difficult life can be when a man becomes a legend in his own time.\r\n\r\n([source][2])\r\n\r\n\r\n  [1]: https://openlibrary.org/works/OL9772092W/The_Name_of_the_Wind\r\n  [2]: https://www.patrickrothfuss.com/content/books.asp",
            "links": [
                {
                    "title": "Official web site",
                    "url": "https://www.patrickrothfuss.com/content/books.asp",
                    "type": {"key": "/type/link"},
                },
                {
                    "title": "The Wise Man's Fear - Wikipedia",
                    "url": "https://en.wikipedia.org/wiki/The_Wise_Man%27s_Fear",
                    "type": {"key": "/type/link"},
                },
                {
                    "title": "The Wise Man\u2019s Fear, by Patrick Rothfuss | The Independent",
                    "url": "https://www.independent.co.uk/arts-entertainment/books/reviews/the-wise-manrsquos-fear-by-patrick-rothfuss-2266395.html",
                    "type": {"key": "/type/link"},
                },
                {
                    "url": "http://www.fantasybookreview.co.uk/Patrick-Rothfuss/The-Wise-Mans-Fear.html",
                    "title": "The Wise Man\u2019s Fear by Patrick Rothfuss book review (fantasybookreview.co.uk)",
                    "type": {"key": "/type/link"},
                },
            ],
            "title": "The Wise Man\u2019s Fear",
            "covers": [8294024, 8259361, 8761697, 9036939, 10837659, 10851212],
            "subject_places": [
                "Severen",
                "The University",
                "The Archives",
                "Tarbean",
                "Ademre",
            ],
            "subjects": [
                "The Kingkiller Chronicle",
                "Magicians",
                "Attempted assassination",
                "Fairies",
                "Fiction",
                "Fantasy",
                "New York Times bestseller",
                "Heroes",
                "Mercenary troops",
                "nyt:hardcover_fiction=2011-05-28",
                "Epic Fantasy",
                "Paranormal Fiction",
                "Wizards",
                "Magic",
                "Phantastischer Roman",
                "Fantasy fiction",
                "Amerikanisches Englisch",
                "Fiction, fantasy, general",
            ],
            "subject_people": [
                "Edema Ruh",
                "Kvothe",
                "Denna",
                "the Chandrian",
                "the Fae",
                "Felurian",
                "Bast",
                "Devi",
                "Chronicler",
                "Ambrose",
                "Maer Alveron",
                "the Cthaeh",
                "Tempi",
                "the Adem",
            ],
            "key": "/works/OL8479869W",
            "authors": [
                {
                    "author": {"key": "/authors/OL2830895A"},
                    "type": {"key": "/type/author_role"},
                }
            ],
            "excerpts": [
                {
                    "comment": "first sentence",
                    "author": {"key": "/people/seabelis"},
                    "excerpt": "Dawn was coming.",
                }
            ],
            "type": {"key": "/type/work"},
            "latest_revision": 34,
            "revision": 34,
            "created": {
                "type": "/type/datetime",
                "value": "2009-12-10T22:50:49.125618",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T18:01:38.943447",
            },
        },
        {
            "title": "Unfettered",
            "covers": [8447672, 10582542],
            "key": "/works/OL19335978W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6274951A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6960940A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6546299A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL4356457A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL5572520A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6789834A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6232882A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL391079A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7133642A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2645644A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL1394865A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6983136A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL3026333A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL1434553A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7309103A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL6605198A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL35996A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7482861A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL468684A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL1394501A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2711187A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7202539A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL9092190A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7868864A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2865776A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7325688A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7927545A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL709314A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7303599A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL8106343A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7991882A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7740992A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7934839A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7928224A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7342432A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7326799A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL3425491A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7935885A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL8648239A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7876206A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7967226A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL3343590A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7833532A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7853814A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL3530908A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7314583A"},
                },
            ],
            "type": {"key": "/type/work"},
            "latest_revision": 8,
            "revision": 8,
            "created": {
                "type": "/type/datetime",
                "value": "2019-03-19T13:57:27.843717",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T17:50:42.112183",
            },
        },
        {
            "type": {"key": "/type/work"},
            "title": "Kingkiller Chronicle Patrick Rothfuss Collection 3 Books Set",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                }
            ],
            "covers": [10866334],
            "key": "/works/OL24343635W",
            "latest_revision": 2,
            "revision": 2,
            "created": {
                "type": "/type/datetime",
                "value": "2021-04-21T22:06:23.079619",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T15:32:51.075084",
            },
        },
        {
            "title": "The Adventures of the Princess and Mr. Whiffle - The Dark of Deep Below",
            "covers": [10115100],
            "key": "/works/OL20814127W",
            "authors": [
                {
                    "author": {"key": "/authors/OL2830895A"},
                    "type": {"key": "/type/author_role"},
                },
                {
                    "author": {"key": "/authors/OL7945185A"},
                    "type": {"key": "/type/author_role"},
                },
            ],
            "type": {"key": "/type/work"},
            "latest_revision": 3,
            "revision": 3,
            "created": {
                "type": "/type/datetime",
                "value": "2020-06-02T22:16:45.436310",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T17:56:25.581994",
            },
        },
        {
            "title": "Rick and Morty vs. Dungeons & Dragons",
            "covers": [8748541],
            "key": "/works/OL20073960W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7303949A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL3928256A"},
                },
            ],
            "type": {"key": "/type/work"},
            "latest_revision": 4,
            "revision": 4,
            "created": {
                "type": "/type/datetime",
                "value": "2019-07-31T20:28:50.537867",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-01-16T10:27:49.161101",
            },
        },
        {
            "title": "Ruzgarin Adi - Kral Katili Guncesi 1. Gun",
            "created": {
                "type": "/type/datetime",
                "value": "2019-09-01T20:51:27.087773",
            },
            "covers": [8774673],
            "last_modified": {
                "type": "/type/datetime",
                "value": "2020-04-21T00:08:17.539437",
            },
            "latest_revision": 2,
            "key": "/works/OL20118208W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                },
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL7830691A"},
                },
            ],
            "type": {"key": "/type/work"},
            "revision": 2,
        },
        {
            "title": "Las aventuras de la Princesa y el se\u00f1or Fu",
            "created": {
                "type": "/type/datetime",
                "value": "2015-03-24T15:38:17.809228",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2015-03-24T15:38:17.809228",
            },
            "latest_revision": 1,
            "key": "/works/OL17093029W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                }
            ],
            "type": {"key": "/type/work"},
            "revision": 1,
        },
        {
            "description": {
                "type": "/type/text",
                "value": "Part of:\r\n\r\n - [The Wise Man's Fear][1]\r\n\r\n\r\n  [1]: https://openlibrary.org/works/OL8479869W/The_Wise_Man%E2%80%99s_Fear",
            },
            "title": "The Wise Man\u2019s Fear [1/2]",
            "key": "/works/OL16817144W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                }
            ],
            "type": {"key": "/type/work"},
            "covers": [11218175],
            "latest_revision": 5,
            "revision": 5,
            "created": {
                "type": "/type/datetime",
                "value": "2014-05-15T13:13:45.807638",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T18:07:36.217988",
            },
        },
        {
            "description": {
                "type": "/type/text",
                "value": "Part of:\r\n\r\n - [The Wise Man's Fear][1]\r\n\r\n\r\n  [1]: https://openlibrary.org/works/OL8479869W/The_Wise_Man%E2%80%99s_Fear",
            },
            "title": "The Wise Man\u2019s Fear [2/2]",
            "key": "/works/OL16817145W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                }
            ],
            "type": {"key": "/type/work"},
            "covers": [11218180],
            "latest_revision": 6,
            "revision": 6,
            "created": {
                "type": "/type/datetime",
                "value": "2014-05-15T13:15:09.402904",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T18:07:49.458138",
            },
        },
        {
            "covers": [6691903, -1],
            "last_modified": {
                "type": "/type/datetime",
                "value": "2011-02-26T04:07:16.573081",
            },
            "latest_revision": 5,
            "key": "/works/OL9772091W",
            "authors": [
                {
                    "type": {"key": "/type/author_role"},
                    "author": {"key": "/authors/OL2830895A"},
                }
            ],
            "created": {
                "type": "/type/datetime",
                "value": "2009-12-11T01:19:24.637966",
            },
            "title": "Your Annotated, Illustrated College Survival Guide",
            "subject_places": ["United States"],
            "subjects": ["College student orientation"],
            "type": {"key": "/type/work"},
            "revision": 5,
        },
        {
            "description": "***SEX INVOLVED!!***\r\n\r\n\r\nThis is a book for children\r\n\r\nIt is a nice, sweet story tale that encourages children to grow up to fuck others!",
            "links": [
                {
                    "url": "http://www.subterraneanpress.com/Merchant2/merchant.mv?Screen=PROD&Product_Code=rothfuss01&Category_Code=NEW&Product_Count=7",
                    "title": "Publishers Page",
                    "type": {"key": "/type/link"},
                }
            ],
            "covers": [6691340, 9055738],
            "key": "/works/OL15678246W",
            "authors": [
                {
                    "author": {"key": "/authors/OL2830895A"},
                    "type": {"key": "/type/author_role"},
                }
            ],
            "title": "The Adventures of the Princess and Mr. Whiffle - The Thing Beneath the Bed",
            "type": {"key": "/type/work"},
            "latest_revision": 9,
            "revision": 9,
            "created": {
                "type": "/type/datetime",
                "value": "2011-02-25T07:57:33.913027",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-07-22T17:52:22.829790",
            },
        },
        {
            "description": {
                "type": "/type/text",
                "value": "Deep below the University, there is a dark place. Few people know of it: a broken web of ancient passageways and abandoned rooms. A young woman lives there, tucked among the sprawling tunnels of the Underthing, snug in the heart of this forgotten place.\r\n\r\nHer name is Auri, and she is full of mysteries.\r\n\r\nThe Slow Regard of Silent Things is a brief, bittersweet glimpse of Auri\u2019s life, a small adventure all her own. At once joyous and haunting, this story offers a chance to see the world through Auri\u2019s eyes. And it gives the reader a chance to learn things that only Auri knows....\r\n\r\nIn this book, Patrick Rothfuss brings us into the world of one of The Kingkiller Chronicle\u2019s most enigmatic characters. Full of secrets and mysteries, The Slow Regard of Silent Things is the story of a broken girl trying to live in a broken world.",
            },
            "title": "A Slow Regard of Silent Things",
            "covers": [
                7309640,
                7906418,
                8542103,
                8671255,
                8775046,
                8999892,
                9934267,
                10367820,
                10635575,
                11218179,
            ],
            "key": "/works/OL17067388W",
            "authors": [
                {
                    "author": {"key": "/authors/OL2830895A"},
                    "type": {"key": "/type/author_role"},
                }
            ],
            "type": {"key": "/type/work"},
            "links": [
                {
                    "title": "Author's website",
                    "url": "http://www.patrickrothfuss.com/content/books.asp",
                    "type": {"key": "/type/link"},
                }
            ],
            "subjects": [
                "Kingkiller chronicle",
                "fantasy",
                "Patrick Rothfuss",
                "slow regard of silent things",
                "name of the wind",
                "wise man's fear",
                "Fiction, fantasy, general",
                "Young women",
                "Loss (Psychology)",
                "Magicians",
                "Fiction",
                "nyt:hardcover-fiction=2014-11-16",
                "New York Times bestseller",
            ],
            "latest_revision": 5,
            "revision": 5,
            "created": {
                "type": "/type/datetime",
                "value": "2014-10-30T09:18:04.678333",
            },
            "last_modified": {
                "type": "/type/datetime",
                "value": "2021-08-06T02:59:27.822564",
            },
        },
    ],
}


def test_parser():
    parser = OpenLibrary()
    result = [x for x in parser.parse_releases(json)]
    assert len(result) == 13
    sample = result[0]
    print("here", sample)
    assert sample == {
        "release_date": "2009-12-10T22:50:49.125618",
        "title": "The Name of the Wind",
        "data": {"last_modified": "2021-12-03T19:06:08.431092", "authors": 1,},
    }
